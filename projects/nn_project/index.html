<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Neural Network Uncertainty | James T. Glazar</title> <meta name="author" content="James T. Glazar"/> <meta name="description" content="Final project for my Big Data Analytics class"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jglazar.github.io/projects/nn_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">James </span>T. Glazar</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">resume</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Neural Network Uncertainty</h1> <p class="post-description">Final project for my Big Data Analytics class</p> </header> <article> <p>Let’s explore my final project for the CIS545 Big Data Analytics class I took at Penn. Throughout the semester, we worked with review data on Amazon products. Our end goal was to many machine learning performance-boosting tricks, such as using bag-of-words features and employing PCA to reduce the dimensionality.</p> <p>My project processes review data using <a href="https://radimrehurek.com/gensim/" target="_blank" rel="noopener noreferrer">gensim</a> and implements a neural network (NN) in <a href="https://keras.io" target="_blank" rel="noopener noreferrer">Keras</a> to predict ratings and their uncertainties. I developed a simple metric to describe the confidence of NN predictions, finding that the NN tends to be most confident in its 1-star predictions.</p> <p>You can follow along with <a href="https://colab.research.google.com/drive/1UYSmG4MCaM9k20Zf6Zxt0yMHVo0xtAt1?usp=sharing" target="_blank" rel="noopener noreferrer">this Google Colab</a> notebook. The main idea is that the NN predicts scores for each star rating, rather than predicting a star rating directly. This lends itself well to uncertainty analysis – we can interpret the close calls as being less certain than the blowouts.</p> <p>I found three main conclusions:</p> <ol> <li>The standard deviation of the scores and the margin (defined as the difference between the two highest scores) lead to similar conclusions. See their correlation in the left figure below.</li> <li>The blowouts tend to exist mainly for negative reviews. The NN picks up on negative words like “bad”, “junk”, “mistake”, “unimpressed”, and “dirty” and makes a confident (and correct) prediction. See the middle figure below.</li> <li>The prediction error and margin are negatively correlated such that higher confidence implies lower error. In other words, the NN is precise AND accurate. See the right figure below.</li> </ol> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/nn-project_margin_vs_stddev.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="margin vs std deviation" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/nn-project_freq_vs_rating_for_margins.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="frequency of each rating, for margin bins" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/nn-project_error_vs_margin.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="error vs margin" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> (left) Frequency of star ratings for low-margin (red), medium-margin (green), and high-margin (blue) predictions. High margin predictions have a clear tendency towards negative reviews, and low margin predictions tpredictions tend to positive reviews. (middle) Standard deviation of predictions vs. margins. The clear positive correlation indicates that either metric will perform similarly (right) Prediction error as a function of prediction margin, binned in increments of 0.1. The negative trend indicates that high-confidence (low margin) NN predictions tend to actually be more accurate. </div> <p>These findings are encapsulated in the table below, which lists the prediction uncertainties for different margins. Now, we can apply this table to quantify uncertainties in the NN predictions! I show in the Google Colab notebook that this leads to fewer surprises, in which NN predictions are far from the actual scores.</p> <table> <thead> <tr> <th>margin</th> <th>error bar</th> </tr> </thead> <tbody> <tr> <td>0.0</td> <td>1.1</td> </tr> <tr> <td>0.1</td> <td>0.8</td> </tr> <tr> <td>0.2</td> <td>0.6</td> </tr> <tr> <td>0.3</td> <td>0.5</td> </tr> <tr> <td>0.4</td> <td>0.4</td> </tr> <tr> <td>0.5</td> <td>0.3</td> </tr> <tr> <td>0.6</td> <td>0.2</td> </tr> <tr> <td>0.7</td> <td>0.2</td> </tr> <tr> <td>0.8</td> <td>0.1</td> </tr> <tr> <td>0.9</td> <td>0.0</td> </tr> <tr> <td>1.0</td> <td>0.0</td> </tr> </tbody> </table> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 James T. Glazar. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>